#### **Задача 7 (обновленная): Обновить `api/endpoints/answer.py`, использовать `common`. (Детализация)**

**Цель:** Обновить эндпоинт проверки ответа.

**Действия:**

1.  **Копирование `api/endpoints/answer.py` в `web-api-service`:**
    *   **Команда:** `cp api/endpoints/answer.py web-api-service/api/endpoints/`
    *   **Обновление импортов в `api/endpoints/answer.py`:**
        ```python
        from fastapi import APIRouter, Depends, HTTPException
        from web_api_service.services.answer_service import AnswerService # Импортируем из web-api-service
        from common.models.pydantic_models import CheckAnswerRequest, CheckAnswerResponse # Импортируем из common
        from api.dependencies import get_answer_service, require_subscription # Импортируем зависимости из web-api-service
        import logging

        logger = logging.getLogger(__name__)

        router = APIRouter()

        @router.post("/answer/check", response_model=CheckAnswerResponse)
        async def check_answer_endpoint(
            request: CheckAnswerRequest,
            answer_service: AnswerService = Depends(get_answer_service),
            _: bool = Depends(require_subscription) # Проверка подписки
        ) -> CheckAnswerResponse:
            try:
                # Вызвать сервис
                result = await answer_service.check_answer(user_id=request.user_id, problem_id=request.problem_id, user_answer=request.user_answer)
                return result
            except Exception as e:
                logger.error(f"Error in check_answer_endpoint: {e}")
                # В зависимости от типа ошибки, можно вернуть разные HTTP статусы
                raise HTTPException(status_code=500, detail="Internal server error during answer check")
        ```

2.  **Копирование `common` в `web-api-service` (если не копируется в Dockerfile):**
    *   **Команда:** `cp -r common web-api-service/`

**Acceptance:**

*   Файл `web-api-service/api/endpoints/answer.py` обновлен.
*   Он импортирует `AnswerService` из `web-api-service/services/answer_service.py`.
*   Он импортирует `CheckAnswerRequest`, `CheckAnswerResponse` из `common.models.pydantic_models`.
*   Он импортирует `get_answer_service`, `require_subscription` из `web-api-service/api/dependencies.py`.
*   Эндпоинт `/answer/check` использует `AnswerService` и проверяет подписку.

---


*   **Задача 7 (обновленная): Обновить `api/endpoints/answer.py`.**
    *   **Дополнительное действие:** После обновления `api/endpoints/answer.py`:
        *   **Тесты (Integration):** `web-api-service/tests/integration/test_api/test_answer_endpoint.py`
            *   Использовать `TestClient` из `fastapi.testclient`.
            *   Мокировать `AnswerService`.
            *   Проверить эндпоинт `/answer/check`: корректные запросы, валидация, вызов сервиса, возврат ответа, обработка ошибок.
        *   **Acceptance:** Эндпоинт `/answer/check` покрыт интеграционным тестом.

